//////////////////////////////////
// System level dependencies

#include <windows.h>

//////////////////////////////////
// ANSI level dependencies

//////////////////////////////////
// Application level dependencies

#include "prc.h"
#include "srv.h"
#include "swiftext.h"
#include "swiftstd.h"
#include "swiftmf.h"
#include "swiftsrv.h"
#include "uneiext.h"
#include "uneigfd.h"
#include "uneistd.h"
#include "uneimf.h"
#include "uneisrv.h"

////////////////////////////////////////////////////
// UNEXIM MESSAGE FORMAT IMPLEMENTATION
// File uneimf.cpp
// Copyright © 1996, Asset Information Management
// Copyright © 1997, Asset Information Management
// Programmer: Dmitry Protopopov
////////////////////////////////////////////////////
// UMT041

BEGIN_IMPLEMENT_PARALLEL(UMT041, "UNEXIM MT041")
  CUSTOM1(UMT041_C, OS_MANTADORY, "MT202\0ben_crdr_f='C'\0")
  CUSTOM1(UMT041_D, OS_MANTADORY, "MT202\0ben_crdr_f='D'\0")
END_IMPLEMENT_PARALLEL(UMT041)

/////////////////////////////////////////////////////
// UMT044

BEGIN_IMPLEMENT_PARALLEL(UMT044, "UNEXIM MT044")
  CUSTOM1(UMT044_C, OS_MANTADORY, "MT202\0ben_crdr_f='C'\0")
  CUSTOM1(UMT044_D, OS_MANTADORY, "MT202\0ben_crdr_f='D'\0")
END_IMPLEMENT_PARALLEL(UMT044)

/////////////////////////////////////////////////////
// UTRAILER

BEGIN_IMPLEMENT_SEQUENCE(UTRAILER, "UNEXIM TRAILER")
  M(UFIELD20F, srvrUneiField20F_TheFilesReference)
  M(UFIELD32F, srvrUneiField32F_ControlAmount)
  M(UFIELD32K, srvrUneiField32K_NumberOfMessagesInTheFile)
  STATIC(OS_MANTADORY, UEOT)
END_IMPLEMENT_SEQUENCE(UTRAILER)

////////////////////////////////////////////////////////////////////////////////////////////////////////////
// IFILEMICEXMESSAGE

BEGIN_IMPLEMENT_SEQUENCE(IFILEMICEXMESSAGE, "MICEX INPUT MESSAGE")
  STATIC(OS_MANTADORY,"\x01")
  CUSTOM1(IMICEXMESSAGE,OS_MANTADORY,"message_desc\0msg_dir='I'\0")
  STATIC(OS_MANTADORY,"\x03")
END_IMPLEMENT_SEQUENCE(IFILEMICEXMESSAGE)

/////////////////////////////////////////////////////////////////
  
// IMICEXAPPHEADER
/*
Note: 

SWIFT outgoing message generated for MICEX
*/

BEGIN_IMPLEMENT_SEQUENCE(IMICEXAPPHEADER, "MICEX INPUT MESSAGE APPLICATION HEADER") 
  STATIC(OS_MANTADORY,"{2:O") 
  TEXT (TS_PUSHFORMATNUMBER, hHeader_MessageType, 

  "500%n\0"
  "501%n\0"
  "502%n\0"
  "510%n\0"
  "512%n\0"
  "513%n\0"
  "514%n\0"
  "515%n\0"
  "516%n\0"
  "517%n\0"
  "518%n\0"
  "519%n\0"
  "520%n\0"
  "521%n\0" 
  "522%n\0"
  "523%n\0" 
  "526%n\0"
  "530%n\0"
  "531%n\0" 
  "532%n\0"
  "533%n\0"
  "534%n\0"
  "550%n\0"
  "551%n\0"
  "552%n\0"
  "553%n\0"
  "554%n\0"
  "555%n\0"
  "556%n\0"  
  "557%n\0"
  "559%n\0" 
  "560%n\0"
  "561%n\0" 
  "562%n\0"
  "563%n\0"
  "570%n\0" 
  "571%n\0" 
  "572%n\0" 
  "573%n\0" 
  "574%n\0"
  "576%n\0" 
  "577%n\0"
  "579%n\0" 
  "580%n\0" 
  "581%n\0" 
  "582%n\0" 
  "583%n\0" 

  "%*1[5]90%n\0" 
  "%*1[5]91%n\0" 
  "%*1[5]92%n\0" 
  "%*1[5]95%n\0" 
  "%*1[5]96%n\0" 
  "%*1[5]98%n\0"
  "%*1[5]99%n\0"

  "900%n\0" 
  "910%n\0" 

  "202%n\0" 
) 
  DATETIME(OS_MANTADORY,hHeader_MessageDate, HHMMYYMMDD) 
  TEXT(OS_MANTADORY,hHeader_Receiver, "<%*10c>%n\0") 
  STATIC(OS_MANTADORY,"0000")
  STATIC(OS_MANTADORY,"000000")
  DATETIME(OS_MANTADORY, hHeader_MessageDate,  YYMMDDHHMM) 
  STATIC(OS_MANTADORY,"N")
  STATIC(OS_MANTADORY,"}") 
END_IMPLEMENT_SEQUENCE(IMICEXAPPHEADER) 

/////////////////////////////////////////////////////////////////
// IMICEXMESSAGE

BEGIN_IMPLEMENT_SEQUENCE(IMICEXMESSAGE, "MICEX INPUT MESSAGE")

  CUSTOM1(ISWIFTF01BASICHEADER,OS_MANTADORY,NULL)
  CUSTOM1(IMICEXAPPHEADER,OS_MANTADORY,NULL)
  //CUSTOM1(ISWIFTUSERHEADER, OS_OPTIONAL, NULL) 

  BEGIN_SWITCH(OS_MANTADORY,NULL)
    CUSTOM1(MT500,OS_MANTADORY,"MT500\0\0")
    CUSTOM1(MT501,OS_MANTADORY,"MT501\0\0")
    CUSTOM1(MT502,OS_MANTADORY,"MT502\0\0")
    CUSTOM1(MT510,OS_MANTADORY,"MT510\0\0")
    CUSTOM1(MT512,OS_MANTADORY,"MT512\0\0")
    CUSTOM1(MT513,OS_MANTADORY,"MT513\0\0")
    CUSTOM1(MT514,OS_MANTADORY,"MT514\0\0")
    CUSTOM1(MT515,OS_MANTADORY,"MT515\0\0")
    CUSTOM1(MT516,OS_MANTADORY,"MT516\0\0")
    CUSTOM1(MT517,OS_MANTADORY,"MT517\0\0")
    CUSTOM1(MT518,OS_MANTADORY,"MT518\0\0")
    CUSTOM1(MT519,OS_MANTADORY,"MT519\0\0")
    CUSTOM1(MT520,OS_MANTADORY,"MT520\0\0")
    CUSTOM1(MT521,OS_MANTADORY,"MT521\0\0")
    CUSTOM1(MT522,OS_MANTADORY,"MT522\0\0")
    CUSTOM1(MT523,OS_MANTADORY,"MT523\0\0")
    CUSTOM1(MT526,OS_MANTADORY,"MT526\0\0")
    CUSTOM1(MT530,OS_MANTADORY,"MT530\0\0")
    CUSTOM1(MT531,OS_MANTADORY,"MT531\0\0")
    CUSTOM1(MT532,OS_MANTADORY,"MT532\0\0")
    CUSTOM1(MT533,OS_MANTADORY,"MT533\0\0")
    CUSTOM1(MT534,OS_MANTADORY,"MT534\0\0")
    CUSTOM1(MT550,OS_MANTADORY,"MT550\0\0")
    CUSTOM1(MT551,OS_MANTADORY,"MT551\0\0")
    CUSTOM1(MT552,OS_MANTADORY,"MT552\0\0")
    CUSTOM1(MT553,OS_MANTADORY,"MT553\0\0")
    CUSTOM1(MT554,OS_MANTADORY,"MT554\0\0")
    CUSTOM1(MT555,OS_MANTADORY,"MT555\0\0")
    CUSTOM1(MT556,OS_MANTADORY,"MT556\0\0")
    CUSTOM1(MT557,OS_MANTADORY,"MT557\0\0")
    CUSTOM1(MT559,OS_MANTADORY,"MT559\0\0")
    CUSTOM1(MT560,OS_MANTADORY,"MT560\0\0")
    CUSTOM1(MT561,OS_MANTADORY,"MT561\0\0")
    CUSTOM1(MT562,OS_MANTADORY,"MT562\0\0")
    CUSTOM1(MT563,OS_MANTADORY,"MT563\0\0")
    CUSTOM1(UMT570,OS_MANTADORY,"MT570\0\0")
    CUSTOM1(MT571,OS_MANTADORY,"MT571\0\0")
    CUSTOM1(UMT572,OS_MANTADORY,"MT572\0\0")
    CUSTOM1(MT573,OS_MANTADORY,"MT573\0\0")
    CUSTOM1(UMT574,OS_MANTADORY,"MT574\0\0")
    CUSTOM1(MT576,OS_MANTADORY,"MT576\0\0")
    CUSTOM1(MT577,OS_MANTADORY,"MT577\0\0")
    CUSTOM1(MT579,OS_MANTADORY,"MT579\0\0")
    CUSTOM1(MT580,OS_MANTADORY,"MT580\0\0")
    CUSTOM1(MT581,OS_MANTADORY,"MT581\0\0")
    CUSTOM1(MT582,OS_MANTADORY,"MT582\0\0")
    CUSTOM1(MT583,OS_MANTADORY,"MT583\0\0")

    CUSTOM1(MTn90,OS_MANTADORY,"MT590\0\0")
    CUSTOM1(MTn91,OS_MANTADORY,"MT591\0\0")
    CUSTOM1(MTn92,OS_MANTADORY,"MT592\0\0")
    CUSTOM1(MTn95,OS_MANTADORY,"MT595\0\0")
    CUSTOM1(MTn96,OS_MANTADORY,"MT596\0\0")
    CUSTOM1(MTn98,OS_MANTADORY,"MT598\0\0")
    CUSTOM1(MTn99,OS_MANTADORY,"MT599\0\0")

    CUSTOM1(MT900,OS_MANTADORY,"MT900\0\0")
    CUSTOM1(MT910,OS_MANTADORY,"MT910\0\0")
 
    CUSTOM1(MT202,OS_MANTADORY,"MT202\0\0")
 END_SWITCH

  //CUSTOM1(ISWIFTTRAILERBLOCK, OS_OPTIONAL, NULL)
  //CUSTOM1(ISWIFTSTBLOCK, OS_OPTIONAL, NULL)

END_IMPLEMENT_SEQUENCE(IMICEXMESSAGE)

/////////////////////////////////////////////////////////////////
// OFILEMICEXMESSAGE

BEGIN_IMPLEMENT_SEQUENCE(OFILEMICEXMESSAGE, "MICEX OUTPUT MESSAGE")
  STATIC(OS_OPTIONAL, EOL)
  STATIC(OS_MANTADORY,"\x01")
  CUSTOM1(OSWIFTACKMESSAGE, OS_OPTIONAL,NULL)
  CUSTOM1(OMICEXMESSAGE,OS_MANTADORY,"message_desc\0msg_dir='O'\0")
  STATIC(OS_MANTADORY,"\x03")
  STATIC(OS_OPTIONAL, EOL)
END_IMPLEMENT_SEQUENCE(OFILEMICEXMESSAGE)

/////////////////////////////////////////////////////////////////////////////////////////////
// OMICEXAPPHEADER

BEGIN_IMPLEMENT_SEQUENCE(OMICEXAPPHEADER, "MICEX OUTPUT MESSAGE APPLICATION HEADER") 
  STATIC(OS_MANTADORY,"{2:O") 

  TEXT(TS_PUSHFORMATNUMBER, hHeader_MessageType, 

  "500%n\0"
  "501%n\0"
  "502%n\0"
  "510%n\0"
  "512%n\0"
  "513%n\0"
  "514%n\0"
  "515%n\0"
  "516%n\0"
  "517%n\0"
  "518%n\0"
  "519%n\0"
  "520%n\0"
  "521%n\0" 
  "522%n\0"
  "523%n\0" 
  "526%n\0"
  "530%n\0"
  "531%n\0" 
  "532%n\0"
  "533%n\0"
  "534%n\0"
  "550%n\0"
  "551%n\0"
  "552%n\0"
  "553%n\0"
  "554%n\0"
  "555%n\0"
  "556%n\0"  
  "557%n\0"
  "559%n\0" 
  "560%n\0"
  "561%n\0" 
  "562%n\0"
  "563%n\0"
  "570%n\0" 
  "571%n\0" 
  "572%n\0" 
  "573%n\0" 
  "574%n\0"
  "576%n\0" 
  "577%n\0"
  "579%n\0" 
  "580%n\0" 
  "581%n\0" 
  "582%n\0" 
  "583%n\0" 

  "%*1[5]90%n\0" 
  "%*1[5]91%n\0" 
  "%*1[5]92%n\0" 
  "%*1[5]95%n\0" 
  "%*1[5]96%n\0" 
  "%*1[5]98%n\0"
  "%*1[5]99%n\0"

  "900%n\0" 
  "910%n\0" 

  "202%n\0" 
) 
  DATETIME(OS_MANTADORY,"_input_date", HHMMYYMMDD) 
  TEXT(OS_MANTADORY,hHeader_Sender, "<%*10c>%n\0") 
  INTEGER(OS_MANTADORY,"_input_session_number", SESSION_NUMBER, "%04lu") 
  INTEGER(OS_MANTADORY,"_input_sequence_number", SEQUENCE_NUMBER, "%06lu") 
  DATETIME(OS_MANTADORY, hHeader_MessageDate,  YYMMDDHHMM) 
  TEXT(OS_MANTADORY,"_priority", "%*1[UN]%n\0") 

  STATIC(OS_MANTADORY,"}") 
END_IMPLEMENT_SEQUENCE(OMICEXAPPHEADER) 

/////////////////////////////////////////////////////////////////
// OMICEXMESSAGE
  
BEGIN_IMPLEMENT_SEQUENCE(OMICEXMESSAGE, "MICEX OUTPUT MESSAGE")

  CUSTOM1(OSWIFTF01BASICHEADER, OS_MANTADORY,NULL)
  CUSTOM1(OMICEXAPPHEADER, OS_MANTADORY,NULL)
  CUSTOM1(OSWIFTUSERHEADER, OS_OPTIONAL,NULL) 

  BEGIN_SWITCH(OS_MANTADORY,NULL)
    CUSTOM1(MT500,OS_MANTADORY,"MT500\0\0")
    CUSTOM1(MT501,OS_MANTADORY,"MT501\0\0")
    CUSTOM1(MT502,OS_MANTADORY,"MT502\0\0")
    CUSTOM1(MT510,OS_MANTADORY,"MT510\0\0")
    CUSTOM1(MT512,OS_MANTADORY,"MT512\0\0")
    CUSTOM1(MT513,OS_MANTADORY,"MT513\0\0")
    CUSTOM1(MT514,OS_MANTADORY,"MT514\0\0")
    CUSTOM1(MT515,OS_MANTADORY,"MT515\0\0")
    CUSTOM1(MT516,OS_MANTADORY,"MT516\0\0")
    CUSTOM1(MT517,OS_MANTADORY,"MT517\0\0")
    CUSTOM1(MT518,OS_MANTADORY,"MT518\0\0")
    CUSTOM1(MT519,OS_MANTADORY,"MT519\0\0")
    CUSTOM1(MT520,OS_MANTADORY,"MT520\0\0")
    CUSTOM1(MT521,OS_MANTADORY,"MT521\0\0")
    CUSTOM1(MT522,OS_MANTADORY,"MT522\0\0")
    CUSTOM1(MT523,OS_MANTADORY,"MT523\0\0")
    CUSTOM1(MT526,OS_MANTADORY,"MT526\0\0")
    CUSTOM1(MT530,OS_MANTADORY,"MT530\0\0")
    CUSTOM1(MT531,OS_MANTADORY,"MT531\0\0")
    CUSTOM1(MT532,OS_MANTADORY,"MT532\0\0")
    CUSTOM1(MT533,OS_MANTADORY,"MT533\0\0")
    CUSTOM1(MT534,OS_MANTADORY,"MT534\0\0")
    CUSTOM1(MT550,OS_MANTADORY,"MT550\0\0")
    CUSTOM1(MT551,OS_MANTADORY,"MT551\0\0")
    CUSTOM1(MT552,OS_MANTADORY,"MT552\0\0")
    CUSTOM1(MT553,OS_MANTADORY,"MT553\0\0")
    CUSTOM1(MT554,OS_MANTADORY,"MT554\0\0")
    CUSTOM1(MT555,OS_MANTADORY,"MT555\0\0")
    CUSTOM1(MT556,OS_MANTADORY,"MT556\0\0")
    CUSTOM1(MT557,OS_MANTADORY,"MT557\0\0")
    CUSTOM1(MT559,OS_MANTADORY,"MT559\0\0")
    CUSTOM1(MT560,OS_MANTADORY,"MT560\0\0")
    CUSTOM1(MT561,OS_MANTADORY,"MT561\0\0")
    CUSTOM1(MT562,OS_MANTADORY,"MT562\0\0")
    CUSTOM1(MT563,OS_MANTADORY,"MT563\0\0")
    CUSTOM1(UMT570,OS_MANTADORY,"MT570\0\0")
    CUSTOM1(MT571,OS_MANTADORY,"MT571\0\0")
    CUSTOM1(UMT572,OS_MANTADORY,"MT572\0\0")
    CUSTOM1(MT573,OS_MANTADORY,"MT573\0\0")
    CUSTOM1(UMT574,OS_MANTADORY,"MT574\0\0")
    CUSTOM1(MT576,OS_MANTADORY,"MT576\0\0")
    CUSTOM1(MT577,OS_MANTADORY,"MT577\0\0")
    CUSTOM1(MT579,OS_MANTADORY,"MT579\0\0")
    CUSTOM1(MT580,OS_MANTADORY,"MT580\0\0")
    CUSTOM1(MT581,OS_MANTADORY,"MT581\0\0")
    CUSTOM1(MT582,OS_MANTADORY,"MT582\0\0")
    CUSTOM1(MT583,OS_MANTADORY,"MT583\0\0")

    CUSTOM1(MTn90,OS_MANTADORY,"MT590\0\0")
    CUSTOM1(MTn91,OS_MANTADORY,"MT591\0\0")
    CUSTOM1(UMT592,OS_MANTADORY,"MT592\0\0")
    CUSTOM1(MTn95,OS_MANTADORY,"MT595\0\0")
    CUSTOM1(MTn96,OS_MANTADORY,"MT596\0\0")
    CUSTOM1(UMT598,OS_MANTADORY,"MT598\0\0")
    CUSTOM1(MTn99,OS_MANTADORY,"MT599\0\0")

    CUSTOM1(MT900,OS_MANTADORY,"MT900\0\0")
    CUSTOM1(MT910,OS_MANTADORY,"MT910\0\0")

    CUSTOM1(MT202,OS_MANTADORY,"MT202\0\0")
  END_SWITCH

  CUSTOM1(OSWIFTTRAILERBLOCK, OS_OPTIONAL, NULL)
  CUSTOM1(OSWIFTSTBLOCK, OS_OPTIONAL, NULL)
END_IMPLEMENT_SEQUENCE(OMICEXMESSAGE)

/////////////////////////////////////////////////////////////////
